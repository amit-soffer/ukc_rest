---
swagger: "2.0"
info:
  description: >-
    The UKC Crypto API provides cryptographic services used with Keys 
    managed by UKC.


    __This API is in draft status and is currently being reviewed__


    # Authentication

    Most UKC API operations require an authorization context and user
    permissions. Users are identified by an authentication token attached to the
    request headers.

    ## Basic Authentication

    UKC supports the basic authentication scheme. The "Basic" HTTP
    authentication scheme is defined in  RFC 7617, which transmits credentials
    as user/password pairs, encoded using base64 in the HTTP Authorization
    header.


    The user ID can include the required partition in the format:

    `username@partitionId:password`

    ## Authentication Token

    The system can authenticate the user with a generated authentication token,
    which is valid for a limited time. This token eliminates the need to
    transmit the  username/password on every request. See `GET /authToken` for
    more information.

    ## Authentication Failure (unauthorized)

    If an operation is unauthorized, an HTTP 401 status code is returned with
    the `WWW-Authenticate` header.

    # Partitioning

    UKC objects are organized into partitions. Partitioning allows namespacing
    and access control to objects by configuring users with roles per partition.


    The objects contained in a partition are: 

    Users, Clients, Keys, Certificates, Secrets and other partitions

    ## Permissions

    Any partition can have many users who can access its objects.

    A partition user can have one of two security roles:

    - **so** - Security Officer. Can perform all operations on the partition
    objects including administration: adding, modifying and deleting objects.

    - **user** - Can only perform cryptographic operations with the partition
    objects, such as sign and verify, and can also edit keys, certificates and
    secrets.

    ## Root Partition

    The default built-in partition for an UKC cluster is called `root` and is
    created automatically when setting up a new UKC cluster.

    ## Partition Hierarchy

    - __Parent partition__ - Any partition, _except_ the root partition, has one
    parent partition.

    - __Permissions inheritance__ - User access permissions can be configured to
    be _inherited_ from the parent partition. For example, a user `userA`, which
    is an SO on `partitionA`, would also have SO permissions on `partitionB` if
    `partitionB` is child of `partitionA`.
        - __Note:__ By default, access permissions are not inherited from the parent partition. To use permission inheritance, it should be configured explicitly.
      
    ## Default Partition Context

    For every request the _default partition_ is the home partition of the
    connected user.


    For example:
      - `so@partitionA` - the default partition is `partitionA`.
      - `user@partitionA.partitionB` - the default partition is `partitionB`, which is a child of `partitionA`.
      - `so@partitionB` - the default partition is `partitionB`, which is child of the root partition.
      
    ## Object Path

    - A UKC object, such as User or Key, can be referenced by its unique object
    path, which may be absolute or relative to the default partition.

    - The object path is unique per object type. Therefore, within one partition
    there can be two objects represented by the same path, one is a key and one
    is a user.

    - UKC object path is composed of a series of path components separated by
    the dot character (`.`).

    - A path component may represent a partition name or object name.
      - The last component in a path is an object name.
    - An absolute path starts with the tilde character `~` which represents the
    root partition.
      - For example, to delete a key named `keyA` that is contained in a partition `partitionC`:
      `DELETE https://myukcserver.com/keys/~.partitionC.keyA`
    - A relative path uses the current default partition as the root of the
    specified path. 
      - If a user is logged in as `so@partitionC`, he can perform the same delete action as in the previous example with:
      `DELETE https://myukcserver.com/keys/keyA`.
      - If the user is logged in as `so@root`, he can use the following as its relative to the root partition:
      `DELETE https://myukcserver.com/keys/partitionC.keyA` 
      
    # Object IDs

    Many operations require an object ID as part of the resource URI. Object ids
    can be one of:

    - An object __UUID__ where applicable. This ID is a server generated ID,
    which is unique per object type.
      - __Note:__ Objects of different types can have the same UUID. For example, user A and key A. That is due to the fact that UUIDs are unique only per object type.
    - An object relative or absolute path as specified above.

    # Quorum
    
    The UKC can be configured to require quorum approval for certain operations. In case the operation you are executing requires it, the http result would be 202 (ACCEPTED) and a quorum job object.
    
    Use the `jobs` API in order to manage approvals for different jobs.
    
    # Common Errors

    Any API call can result in one of the following general HTTP codes:

    - 500 - General server error.

    - 404 - Resource not found. Verify that the URL exists.

    - 401 - Unauthorized
  version: 2.0.1807
  title: Unbound Key Control Server
  termsOfService: ''
  contact:
    name: UKC Administration API,
    url: http://www.unboundtech.com,
    email: support@unboundtech.com
  license: {
    name: '',
    url: 'http://www.unboundtech.com'
  }
tags:
- name: "Keys"
- name: "Secrets"
schemes:
- "https"
paths:
  /api/v1/keys:
    get:
      tags:
      - "Keys"
      summary: "List key objects"
      description: "Return a list of keys"
      operationId: "listKeys"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "type"
        in: "query"
        description: "Key type"
        required: false
        type: "string"
        enum:
        - "RSA"
        - "ECC"
        - "AES"
        - "TDES"
        - "HMAC"
        - "SIV"
        - "PRF"
        - "PWD"
        - "LIMA"
      - name: "exportType"
        in: "query"
        description: "exportType"
        required: false
        type: "string"
        enum:
        - "IN_PLAIN"
        - "WRAPPED"
        - "WRAPPED_WITH_TRUSTED"
        - "NON_EXPORTABLE"
      - name: "trusted"
        in: "query"
        description: "Is Trusted"
        required: false
        type: "boolean"
      - name: "detailed"
        in: "query"
        description: "Detailed"
        required: false
        type: "boolean"
        default: false
      responses:
        200:
          description: "OK"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/KeyInfo"
      security:
      - basicAuth: []
      - Authorization: []
    post:
      tags:
      - "Keys"
      summary: "Import a new asymmetric key"
      description: "Import a new key based on the given file"
      operationId: "importKey"
      consumes:
      - "multipart/form-data"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "file"
        in: "formData"
        description: "key file"
        required: true
        type: "file"
      - name: "id"
        in: "formData"
        description: "key id"
        required: true
        type: "string"
      - name: "password"
        in: "formData"
        description: "password for the file if required"
        required: false
        type: "string"
      - name: "description"
        in: "formData"
        description: "key description"
        required: false
        type: "string"
      - name: "usage"
        in: "formData"
        description: "key usage"
        required: false
        type: "string"
      - name: "exportType"
        in: "formData"
        description: "Export Type"
        required: false
        type: "string"
      - name: "trusted"
        in: "formData"
        description: "trusted (yes or not)"
        required: false
        type: "boolean"
      - name: "keyOnly"
        in: "formData"
        description: "import only key (no chain)"
        required: false
        type: "boolean"
      - name: "testMode"
        in: "formData"
        description: "get key info without importing"
        required: false
        type: "boolean"
      responses:
        201:
          description: "Key generated successfully"
          schema:
            $ref: "#/definitions/KeyInfo"
        409:
          description: "Object already exist"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/generate:
    post:
      tags:
      - "Keys"
      summary: "Generate  new asymmetric key, key format is provided as a parameter"
      description: "Generate a new key based on provided parameters"
      operationId: "generateKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - in: "body"
        name: "body"
        description: "The new key"
        required: false
        schema:
          $ref: "#/definitions/NewGeneratedKey"
      responses:
        201:
          description: "Key generated successfully"
          schema:
            $ref: "#/definitions/KeyInfo"
        409:
          description: "Object already exist"
          schema:
            $ref: "#/definitions/KeyInfo"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}:
    get:
      tags:
      - "Keys"
      summary: "Get key detailed key information"
      description: ""
      operationId: "getKey"
      produces:
      - "application/json"
      parameters:
      - name: "keyId"
        in: "path"
        description: "Key ID to look for"
        required: true
        type: "string"
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "detailed"
        in: "query"
        description: "Detailed"
        required: false
        type: "boolean"
        default: true
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/KeyInfo"
      security:
      - basicAuth: []
      - Authorization: []
    delete:
      tags:
      - "Keys"
      summary: "Delete a key"
      description: "Delete provided key"
      operationId: "deleteKey"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key ID to delete"
        required: true
        type: "string"
      responses:
        200:
          description: "OK"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/decrypt:
    post:
      tags:
      - "Keys"
      summary: "Decrypt a value using a key"
      description: "Decryption is done using the key. Same parameters for encryption\
        \ are supported, as well as both simple and unseal mode, in case of symmetric\
        \ key, only simple mode is supported. If decryption fails with latest key\
        \ version the previous version (if such exist) will be used, etc."
      operationId: "decryptWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "The key used for decryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Data to decrypt"
        required: false
        schema:
          $ref: "#/definitions/DecryptData"
      responses:
        200:
          description: "OK. Returns clear text encoded according to request parameters"
          schema:
            $ref: "#/definitions/ClearText"
        400:
          description: "Authentication encryption failure"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/decryptx:
    post:
      tags:
      - "Keys"
      summary: "Decrypt multiple values using a key"
      description: "Decryption is done using the key. Same parameters for encryption\
        \ are supported, as well as both simple and unseal mode, in case of symmetric\
        \ key, only simple mode is supported. If decryption fails with latest key\
        \ version the previous version (if such exist) will be used, etc."
      operationId: "multiDecryptWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "The key used for decryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "TODO"
        required: false
        schema:
          $ref: "#/definitions/Decryptx"
      responses:
        200:
          description: "Array of decrypted values with requested encoding"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/ClearText"
        400:
          description: "Authentication encryption failure"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/encrypt:
    post:
      tags:
      - "Keys"
      summary: "Encrypt clear text into cipher text with an existing key"
      description: "Encryption is done using the key. Parameters allow selecting padding\
        \ mode and encryption mode. If key type is asymmetric encryption is done exactly\
        \ as encryption with a certificate, if key type is symmetric only simple mode\
        \ is supported."
      operationId: "encryptWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Id of the Key used for encryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Data to encrypt"
        required: false
        schema:
          $ref: "#/definitions/EncryptData"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Cipher"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/encryptx:
    post:
      tags:
      - "Keys"
      summary: "Encrypt multiple values with an existing key"
      description: "Encryption is done using the key. Parameters allow selecting padding\
        \ mode and encryption mode. If key type is asymmetric encryption is done exactly\
        \ as encryption with a certificate, if key type is symmetric only simple mode\
        \ is supported."
      operationId: "multiEncryptWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key used for encryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "TODO"
        required: false
        schema:
          $ref: "#/definitions/Encryptx"
      responses:
        200:
          description: "OK"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Cipher"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/mac:
    post:
      tags:
      - "Keys"
      summary: "Creates a Message Authentication Code (MAC) for a message using a\
        \ key"
      description: "Generate MAC for a message. MAC mode is provided as a parameter."
      operationId: "createMacWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key used for MAC"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Mac Data"
        required: false
        schema:
          $ref: "#/definitions/MACSignData"
      responses:
        200:
          description: "OK. Returns the generated Message Authentication Code"
          schema:
            $ref: "#/definitions/Mac"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/macVerify:
    post:
      tags:
      - "Keys"
      summary: "Verify a Message Authentication Code (MAC) using a key"
      description: "Verifies a MAC value. Supports the same parameters as the MAC\
        \ option."
      operationId: "verifyMacWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key used for verification"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Mac Verify Data"
        required: false
        schema:
          $ref: "#/definitions/MACVerifyData"
      responses:
        200:
          description: "OK. Verified Successfully"
        400:
          description: "Verification failed"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/public:
    get:
      tags:
      - "Keys"
      summary: "Get key public data"
      description: "Return the public details of an asymmetric key or exportable symmetric key"
      operationId: "getPublicKeyData"
      produces:
      - "application/json"
      parameters:
      - name: "keyId"
        in: "path"
        description: "Key ID to look for"
        required: true
        type: "string"
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "obfuscate"
        in: "query"
        description: "Add obfuscated private key as part of the encoded data, relevant only for PKI keys."
        required: false
        type: "boolean"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Key"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/renew:
    post:
      tags:
      - "Keys"
      summary: "Renew an existing key. A link is created between the old key and the\
        \ new one."
      description: "Create a new key with the same parameters as the existing one. The\
        \ new key inherits the current key ID and a link is created between the\
        \ two keys."
      operationId: "renewKey"
      consumes:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "The key to move. This could be either a key UID or label."
        required: true
        type: "string"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/KeyInfo"
        201:
          description: "OK. Key renewed successfully."
          schema:
            $ref: "#/definitions/KeyInfo"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/seal:
    post:
      tags:
      - "Keys"
      summary: "Encrypt clear text into cipher text with an existing key"
      description: "Encryption is done using the key. Parameters allow selecting padding\
        \ mode and encryption mode. If key type is asymmetric encryption is done exactly\
        \ as encryption with a certificate, if key type is symmetric only simple mode\
        \ is supported."
      operationId: "sealWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Id of the Key used for encryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Data to seal"
        required: false
        schema:
          $ref: "#/definitions/SealData"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/SealedCipher"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/sign:
    post:
      tags:
      - "Keys"
      summary: "Sign a message using a key"
      description: "Hash and sign a given message. If requested can also assume the\
        \ input is a hash value and just sign it. Different modes are supported as\
        \ parameters and output can be either raw signature or PKCS7, based on request."
      operationId: "signWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key used for signing"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "TODO"
        required: false
        schema:
          $ref: "#/definitions/SignData"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Signature"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/unseal:
    post:
      tags:
      - "Keys"
      summary: "Decrypt a value using a key"
      description: "Decryption is done using the key. Same parameters for encryption\
        \ are supported, as well as both simple and unseal mode, in case of symmetric\
        \ key, only simple mode is supported. If decryption fails with latest key\
        \ version the previous version (if such exist) will be used, etc."
      operationId: "unSealWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "The key used for decryption"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Data to un-seal"
        required: false
        schema:
          $ref: "#/definitions/UnSealData"
      responses:
        200:
          description: "OK. Returns clear text encoded according to request parameters"
          schema:
            $ref: "#/definitions/ClearText"
        400:
          description: "Authentication encryption failure"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/value:
    get:
      tags:
      - "Keys"
      summary: "Get key data"
      description: "Return public details of an asymmetric key or exportable symmetric\
        \ key"
      operationId: "getKeyData"
      produces:
      - "application/json"
      parameters:
      - name: "keyId"
        in: "path"
        description: "Key ID to look for"
        required: true
        type: "string"
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Key"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/verify:
    post:
      tags:
      - "Keys"
      summary: "Verify a signature using a key"
      description: "Verifies a signature value. Supports the same parameters as the\
        \ signing option."
      operationId: "verifyWithKey"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Certificate used for verification"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "TODO"
        required: false
        schema:
          $ref: "#/definitions/VerifyData"
      responses:
        200:
          description: "OK. Signature verified successfully"
        400:
          description: "Verification failed"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/keys/{keyId}/wrap:
    post:
      tags:
      - "Keys"
      summary: "Wrap and export a key with an existing key"
      description: ""
      operationId: "wrap"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "keyId"
        in: "path"
        description: "Key used for wrapping"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "Wrap data"
        required: false
        schema:
          $ref: "#/definitions/WrapData"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Cipher"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets:
    get:
      tags:
      - "Secrets"
      summary: "List all secrets in a partition"
      description: "Return a list of all secrets in a partition"
      operationId: "listSecrets"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      responses:
        200:
          description: "OK"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Secret"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/file:
    post:
      tags:
      - "Secrets"
      summary: "Adds a new secret"
      description: "Add new secret data with label"
      operationId: "addFileSecret"
      consumes:
      - "multipart/form-data"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "newSecret"
        in: "formData"
        description: "secret data"
        required: true
        type: "file"
      - name: "id"
        in: "formData"
        description: "secret id"
        required: true
        type: "string"
      - name: "description"
        in: "formData"
        description: "key description"
        required: false
        type: "string"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/Secret"
        201:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
        409:
          description: "Secret with this ID already exists"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/generate:
    post:
      tags:
      - "Secrets"
      summary: "Generate a new secret"
      description: "Add new secret data with label"
      operationId: "generateSecret"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - in: "body"
        name: "body"
        description: "newSecret"
        required: false
        schema:
          $ref: "#/definitions/NewGeneratedSecret"
      - name: "complexity"
        in: "query"
        description: "complexity"
        required: false
        type: "boolean"
        default: true
      - name: "length"
        in: "query"
        description: "length"
        required: false
        type: "integer"
        default: 8
        maximum: 32767
        minimum: 1
        format: "int32"
      responses:
        200:
          description: "Successful operation"
          schema:
            $ref: "#/definitions/Secret"
        201:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
        409:
          description: "Secret with this ID already exist"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/text:
    post:
      tags:
      - "Secrets"
      summary: "Adds a new secret"
      description: "Add new secret data with label"
      operationId: "addTextSecret"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - in: "body"
        name: "body"
        description: "newSecret"
        required: false
        schema:
          $ref: "#/definitions/NewSecret"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/Secret"
        201:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
        409:
          description: "Secret with this ID already exist"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/{secretId}:
    get:
      tags:
      - "Secrets"
      summary: "Get the info of an existing secret"
      description: "Return the value of a secret"
      operationId: "getSecret"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID to look for"
        required: true
        type: "string"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
      security:
      - basicAuth: []
      - Authorization: []
    delete:
      tags:
      - "Secrets"
      summary: "Deletes a secret"
      description: "Deletes a secret by its label/ID"
      operationId: "deleteSecret"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID to delete"
        required: true
        type: "string"
      responses:
        200:
          description: "OK"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/{secretId}/file:
    get:
      tags:
      - "Secrets"
      summary: "Get the value of an existing secret"
      description: "Return the value of a secret"
      operationId: "getSecretFileData"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      - "application/octet-stream"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID to look for"
        required: true
        type: "string"
      responses:
        200:
          description: "OK"
          schema:
            type: "file"
      security:
      - basicAuth: []
      - Authorization: []
    put:
      tags:
      - "Secrets"
      summary: "Update existing secret"
      description: "Update existing secret"
      operationId: "updateFileSecret"
      consumes:
      - "multipart/form-data"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID"
        required: true
        type: "string"
      - name: "newSecret"
        in: "formData"
        description: "secret data"
        required: true
        type: "file"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
      security:
      - basicAuth: []
      - Authorization: []
  /api/v1/secrets/{secretId}/text:
    get:
      tags:
      - "Secrets"
      summary: "Get the value of an existing secret"
      description: "Return the value of a secret"
      operationId: "getSecretTextData"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      - "text/plain"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID to look for"
        required: true
        type: "string"
      responses:
        200:
          description: "OK"
          schema:
            type: "string"
      security:
      - basicAuth: []
      - Authorization: []
    put:
      tags:
      - "Secrets"
      summary: "Update existing secret"
      description: "Update existing secret"
      operationId: "updateTextSecret"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "partitionId"
        in: "query"
        description: "Partition ID"
        required: false
        type: "string"
      - name: "secretId"
        in: "path"
        description: "Secret ID"
        required: true
        type: "string"
      - in: "body"
        name: "body"
        description: "updatedSecret"
        required: false
        schema:
          $ref: "#/definitions/UpdatedSecret"
      responses:
        200:
          description: "OK"
          schema:
            $ref: "#/definitions/Secret"
      security:
      - basicAuth: []
      - Authorization: []
securityDefinitions:
  Authorization:
    description: "For accessing the API a valid JWT token must be passed in all the\
      \ queries in\nthe 'Authorization' header.\nA valid JWT token is generated by\
      \ the API and retourned as answer of a call\nto the route /login giving a valid\
      \ user and password.\nThe following syntax must be \nused in the 'Authorization'\
      \ header :\n       Bearer: xxxxxx.yyyyyyy.zzzzzz"
    type: "apiKey"
    name: "Authorization"
    in: "header"
  basicAuth:
    type: "basic"
definitions:
  Aad:
    type: "object"
    required:
    - "value"
    properties:
      value:
        type: "string"
        description: "Authentication data"
      encoding:
        type: "string"
        description: "Authentication data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
  AlternativeNames:
    type: "object"
    required:
    - "isCritical"
    - "uid"
    properties:
      names:
        type: "array"
        items:
          type: "string"
      uid:
        type: "string"
        description: "Extension UID"
      isCritical:
        type: "boolean"
        description: "Is Extension Critical"
    description: "Certificate x509 extension"
  AsymmetricCryptoParams:
    type: "object"
    properties:
      padding:
        description: "the padding information"
        $ref: "#/definitions/Padding"
      hash:
        type: "string"
        description: "the hash type"
        enum:
        - "SHA1"
        - "SHA256"
        - "SHA384"
        - "SHA512"
  AuthorityKeyIdentifier:
    type: "object"
    required:
    - "isCritical"
    - "uid"
    properties:
      uid:
        type: "string"
        description: "Extension UID"
      isCritical:
        type: "boolean"
        description: "Is Extension Critical"
      keyId:
        type: "string"
        readOnly: true
      authNames:
        type: "array"
        items:
          type: "string"
      serialNumber:
        type: "string"
    description: "Certificate x509 extension"
  BasicConstraints:
    type: "object"
    required:
    - "isCritical"
    - "uid"
    properties:
      uid:
        type: "string"
        description: "Extension UID"
      isCritical:
        type: "boolean"
        description: "Is Extension Critical"
      pathLen:
        type: "integer"
        format: "int32"
      isCa:
        type: "boolean"
    description: "Certificate x509 extension"
  CertificateInfo:
    type: "object"
    required:
    - "id"
    - "isCa"
    - "isSelfSigned"
    - "issuer"
    - "pkInfo"
    - "serial"
    - "signature"
    - "signatureAlgorithm"
    - "subject"
    - "uid"
    - "validFrom"
    - "validUntil"
    - "version"
    properties:
      id:
        type: "string"
        example: "my-certificate"
        description: "Certificate identifier label"
      uid:
        type: "string"
      sha1Thumbprint:
        type: "string"
      version:
        type: "string"
        example: "V3"
        description: "Certificate version"
      serial:
        type: "string"
        example: "185fb61e97f55b19"
        description: "Certificate serial number"
      signatureAlgorithm:
        type: "string"
        example: "sha256RSA"
        description: "Signing algorithm used for signing this certificate"
      issuer:
        type: "string"
        description: "The CA that signed this certificate"
      validFrom:
        type: "string"
        description: "Date of of validity period start for this certificate"
      validUntil:
        type: "string"
        description: "Date of of validity period end for this certificate"
      subject:
        type: "string"
      pkInfo:
        $ref: "#/definitions/PKInfoType"
      basicConstraints:
        description: "Basic Constraints Extension"
        $ref: "#/definitions/BasicConstraints"
      subjectKeyIdentifier:
        description: "Subject Key Identifier Extension"
        $ref: "#/definitions/SubjectKeyIdentifier"
      authorityKeyIdentifier:
        description: "Authority Key Identifier Extension"
        $ref: "#/definitions/AuthorityKeyIdentifier"
      subjectAlternativeNames:
        description: "Subject Alternative Names Extension"
        $ref: "#/definitions/AlternativeNames"
      issuerAlternativeNames:
        description: "Issuer Alternative Names Extension"
        $ref: "#/definitions/AlternativeNames"
      extendedKeyUsage:
        description: "Extended Key Usage Extension"
        $ref: "#/definitions/ExtendedKeyUsage"
      signature:
        type: "string"
        description: "CA signature value for this certificate"
      isCa:
        type: "boolean"
        description: "Determines if this certificate is a CA certificate"
      isSelfSigned:
        type: "boolean"
        description: "Determines if this certificate is a self signed certificate"
    description: "Certificate public information"
  Cipher:
    type: "object"
    required:
    - "cipherTextBase64"
    properties:
      cipherTextBase64:
        type: "string"
        description: "base64 encoded encrypted data"
        minLength: 1
      ivBase64:
        type: "string"
        description: "base64 encoded Initialize Vector"
    description: "Includes encrypted data"
  ClearText:
    type: "object"
    properties:
      clearText:
        type: "string"
  DecryptData:
    type: "object"
    required:
    - "cipher"
    properties:
      aSymmetricParams:
        description: "Asymmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/AsymmetricCryptoParams"
      symmetricParams:
        description: "symmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/SymmetricCryptoParams"
      cipher:
        description: "the cipher to decrypt"
        $ref: "#/definitions/Cipher"
      outputEncoding:
        type: "string"
        description: "the decrypted result encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
    description: "Input for a decrypt operation"
  Decryptx:
    type: "object"
    required:
    - "encrypted"
    properties:
      encrypted:
        type: "array"
        items:
          $ref: "#/definitions/Cipher"
      params:
        $ref: "#/definitions/SymmetricCryptoParams"
      outputEncoding:
        type: "string"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
    description: "Input for multi decrypt operation"
  ECCKeyInfoType:
    type: "object"
    required:
    - "curve"
    - "ecPoint"
    properties:
      curve:
        type: "string"
        enum:
        - "P256"
        - "P384"
        - "P521"
        - "SECP_256K_1"
      ecPoint:
        type: "string"
        description: "Encoded public key (EC point)"
    description: "Details of ECC public key"
  EncryptData:
    type: "object"
    required:
    - "clearText"
    properties:
      aSymmetricParams:
        description: "Asymmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/AsymmetricCryptoParams"
      symmetricParams:
        description: "symmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/SymmetricCryptoParams"
      clearText:
        type: "string"
        description: "data to encrypt"
        minLength: 1
      dataEncoding:
        type: "string"
        description: "the input data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
    description: "Input for encryption"
  Encryptx:
    type: "object"
    required:
    - "clearTextItems"
    properties:
      clearTextItems:
        type: "array"
        description: "Array of clearText items to encrypt"
        items:
          type: "string"
      dataEncoding:
        type: "string"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
      params:
        $ref: "#/definitions/SymmetricCryptoParams"
    description: "Input for encryption of multiple values"
  ExtendedKeyUsage:
    type: "object"
    required:
    - "isCritical"
    - "uid"
    properties:
      keyUsages:
        type: "array"
        items:
          type: "string"
      uid:
        type: "string"
        description: "Extension UID"
      isCritical:
        type: "boolean"
        description: "Is Extension Critical"
    description: "Certificate x509 extension"
  Iv:
    type: "object"
    required:
    - "value"
    properties:
      value:
        type: "string"
        description: "Externally provided IV"
      encoding:
        type: "string"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
  Key:
    type: "object"
    properties:
      keyData:
        type: "string"
        description: "base64 encoded key data"
  KeyFormat:
    type: "object"
    required:
    - "type"
    properties:
      type:
        type: "string"
        description: "key type"
        enum:
        - "RSA"
        - "ECC"
        - "AES"
        - "TDES"
        - "HMAC"
        - "SIV"
        - "PRF"
        - "PWD"
        - "LIMA"
      size:
        type: "integer"
        format: "int32"
        example: "for RSA : {2048,3072,4094}"
        description: "key size"
      curve:
        type: "string"
        description: "requited for ecliptic curve"
        enum:
        - "P256"
        - "P384"
        - "P521"
        - "SECP_256K_1"
  KeyInfo:
    type: "object"
    properties:
      id:
        type: "string"
        example: "my-key"
        description: "key identifier label"
        readOnly: true
      uid:
        type: "string"
        example: "0x00d78d6a396072e9a0"
        description: "key identifier"
        readOnly: true
      objectType:
        type: "string"
        description: "object type"
        readOnly: true
        enum:
        - "CERTIFICATE"
        - "PRIVATE_KEY"
        - "SYMMETRIC"
        - "PUBLIC_KEY"
      keyFormat:
        readOnly: true
        $ref: "#/definitions/KeyFormat"
      keyProperties:
        readOnly: true
        $ref: "#/definitions/KeyProperties"
      local:
        type: "boolean"
        description: "Was this key created inside UKC or imported"
        readOnly: true
      hasCertificate:
        type: "boolean"
        description: "Does this key have a matching certificate in UKC"
        readOnly: true
      certificateOnly:
        type: "boolean"
        description: "Does this certificate not have a matching certificate in\
          \ EKM?"
        readOnly: true
      prev:
        type: "string"
        description: "Does the key have previous key (created by a move operation)?"
        readOnly: true
      pkInfo:
        description: "Private key (RSA/ECC) information"
        readOnly: true
        $ref: "#/definitions/PKInfoType"
      chain:
        type: "array"
        description: "Private key (RSA/ECC) information"
        readOnly: true
        items:
          $ref: "#/definitions/CertificateInfo"
      createdAt:
        type: "string"
        description: "Creation date"
        readOnly: true
      updatedAt:
        type: "string"
        description: "Last update date"
        readOnly: true
    description: "Key object details"
  KeyProperties:
    type: "object"
    properties:
      description:
        type: "string"
        description: "Description for the key"
      supportedOperations:
        type: "array"
        description: "The key Supported operations"
        items:
          type: "string"
          enum:
          - "SIGN"
          - "VERIFY"
          - "ENCRYPT"
          - "DECRYPT"
          - "WRAP"
          - "UNWRAP"
          - "DERIVE"
      trusted:
        type: "boolean"
        description: "Is the key trusted?"
      exportType:
        type: "string"
        enum:
        - "IN_PLAIN"
        - "WRAPPED"
        - "WRAPPED_WITH_TRUSTED"
        - "NON_EXPORTABLE"
  Label:
    type: "object"
    required:
    - "value"
    properties:
      value:
        type: "string"
      encoding:
        type: "string"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
  MACSignData:
    type: "object"
    required:
    - "data"
    properties:
      data:
        type: "string"
        description: "data"
        minLength: 1
      dataEncoding:
        type: "string"
        description: "data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
      params:
        $ref: "#/definitions/MacCryptoParams"
    description: "Input for MAC operation"
  MACVerifyData:
    type: "object"
    required:
    - "data"
    - "mac"
    properties:
      data:
        type: "string"
        description: "data"
        minLength: 1
      dataEncoding:
        type: "string"
        description: "data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
      params:
        $ref: "#/definitions/MacCryptoParams"
      mac:
        description: "MAC value to be verified, encoded as BASE64"
        $ref: "#/definitions/Mac"
    description: "Includes data used for MAC verification"
  Mac:
    type: "object"
    properties:
      mac:
        type: "string"
        example: "c2Rmc2FkZmFzZGZhIHNkZmFzZGZzMjM0MjM0MzQyIGRmIGFzZGZhIDMz"
      ivBase64:
        type: "string"
        description: "base64 encoded Initialize Vector"
  MacCryptoParams:
    type: "object"
    properties:
      mode:
        type: "string"
        description: "Mode of operation"
        enum:
        - "GMAC"
        - "CMAC"
        - "HMAC"
      iv:
        description: "Externally provided IV, default encoded in BAS64"
        $ref: "#/definitions/Iv"
      tagLength:
        type: "integer"
        format: "int32"
  NewGeneratedKey:
    type: "object"
    required:
    - "keyFormat"
    - "keyId"
    properties:
      keyId:
        type: "string"
        description: "An id for the new key"
        minLength: 1
      keyFormat:
        $ref: "#/definitions/KeyFormat"
      keyProperties:
        $ref: "#/definitions/KeyProperties"
  NewGeneratedSecret:
    type: "object"
    required:
    - "id"
    properties:
      id:
        type: "string"
        example: "mySecret1"
        description: "An identifier/label for the secret data"
        minLength: 1
      description:
        type: "string"
        description: "the secret description"
  NewSecret:
    type: "object"
    required:
    - "data"
    - "id"
    properties:
      id:
        type: "string"
        example: "mySecret1"
        description: "An identifier/label for the secret data"
        minLength: 1
      description:
        type: "string"
        description: "The secret description"
      data:
        type: "string"
        example: "My secret data"
        description: "The data to keep as secret"
        minLength: 1
  OAEPPadding:
    type: "object"
    properties:
      mgf:
        type: "string"
        enum:
        - "SHA1"
        - "SHA256"
        - "SHA384"
        - "SHA512"
      label:
        description: "OAEP label, default encoding as PLAIN"
        $ref: "#/definitions/Label"
    description: "OAEP padding parameters"
  PKInfoType:
    type: "object"
    properties:
      rsa:
        $ref: "#/definitions/RSAKeyInfoType"
      ecc:
        $ref: "#/definitions/ECCKeyInfoType"
    description: "Properties of PKI key"
  PSSPadding:
    type: "object"
    properties:
      mgf:
        type: "string"
        description: "the mgf hash algorithm"
        enum:
        - "SHA1"
        - "SHA256"
        - "SHA384"
        - "SHA512"
      saltSize:
        type: "integer"
        format: "int32"
        description: "the salt size"
    description: "PSS padding parameters"
  Padding:
    type: "object"
    required:
    - "type"
    properties:
      type:
        type: "string"
        enum:
        - "PKCS1"
        - "OAEP"
        - "PSS"
      pss:
        $ref: "#/definitions/PSSPadding"
      oaep:
        $ref: "#/definitions/OAEPPadding"
    description: "Crypto operation padding type"
  RSAKeyInfoType:
    type: "object"
    required:
    - "modulus"
    - "publicExponent"
    properties:
      publicExponent:
        type: "string"
        description: "HEX encoded exponent"
      modulus:
        type: "string"
        description: "HEX encoded modulus"
    description: "Details of RSA public key"
  SealData:
    type: "object"
    required:
    - "clearText"
    properties:
      clearText:
        type: "string"
        description: "Data to seal"
        minLength: 1
      dataEncoding:
        type: "string"
        description: "the data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
  SealedCipher:
    type: "object"
    required:
    - "value"
    properties:
      value:
        type: "string"
        description: "base64 encoded sealed value"
        minLength: 1
  Secret:
    type: "object"
    required:
    - "id"
    properties:
      id:
        type: "string"
        example: "mySecret1"
        description: "An identifier/label for the secret data"
      description:
        type: "string"
        description: "The secret description"
        readOnly: true
      uid:
        type: "string"
        example: "0x00d78d6a396072e9a0"
        description: "Secret identifier"
        readOnly: true
      createdAt:
        type: "string"
        description: "Creation date"
        readOnly: true
      updatedAt:
        type: "string"
        description: "Last update date"
        readOnly: true
  SignData:
    type: "object"
    required:
    - "data"
    properties:
      data:
        type: "string"
        description: "data"
      dataEncoding:
        type: "string"
        description: "data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
      params:
        description: "the operation parameters"
        $ref: "#/definitions/AsymmetricCryptoParams"
      doHash:
        type: "boolean"
        description: "do hash or not"
    description: "Input for sign operation"
  Signature:
    type: "object"
    properties:
      signature:
        type: "string"
        example: "c2Rmc2FkZmFzZGZhIHNkZmFzZGZzIGRmIGFzZGZhIHNkZmFzZGZhc2Q="
        description: "base64 encoded signature"
  SubjectKeyIdentifier:
    type: "object"
    required:
    - "isCritical"
    - "uid"
    properties:
      uid:
        type: "string"
        description: "Extension UID"
      isCritical:
        type: "boolean"
        description: "Is Extension Critical"
      keyId:
        type: "string"
        readOnly: true
    description: "Certificate x509 extension"
  SymmetricCryptoParams:
    type: "object"
    properties:
      mode:
        type: "string"
        description: "Mode of operation"
        enum:
        - "ECB"
        - "CBC"
        - "OFB"
        - "CFB"
        - "CTR"
        - "GCM"
        - "CCM"
        - "XTS"
        - "SIV"
        - "NISTWRAP"
      iv:
        description: "Externally provided IV, default encoded in BAS64"
        $ref: "#/definitions/Iv"
      aad:
        description: "Authentication data, default encoded in PLAIN"
        $ref: "#/definitions/Aad"
      tagLength:
        type: "integer"
        format: "int32"
  UnSealData:
    type: "object"
    required:
    - "cipher"
    properties:
      cipher:
        description: "cipher to decrypt"
        $ref: "#/definitions/SealedCipher"
      outputEncoding:
        type: "string"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
  UpdatedSecret:
    type: "object"
    required:
    - "data"
    properties:
      data:
        type: "string"
        example: "My secret data"
        description: "The data to keep as secret"
        minLength: 1
  VerifyData:
    type: "object"
    required:
    - "data"
    - "signature"
    properties:
      data:
        type: "string"
        description: "data"
      dataEncoding:
        type: "string"
        description: "data encoding"
        enum:
        - "PLAIN"
        - "BASE64"
        - "HEX"
      params:
        description: "the operation parameters"
        $ref: "#/definitions/AsymmetricCryptoParams"
      doHash:
        type: "boolean"
        description: "do hash or not"
      signature:
        description: "Signature, encoded as BAS64"
        $ref: "#/definitions/Signature"
    description: "Includes data used for signature verification"
  WrapData:
    type: "object"
    required:
    - "wrappedKeyId"
    properties:
      aSymmetricParams:
        description: "Asymmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/AsymmetricCryptoParams"
      symmetricParams:
        description: "Symmetric cryptographic parameters for symmetric keys"
        $ref: "#/definitions/SymmetricCryptoParams"
      wrappedKeyId:
        type: "string"
        description: "ID of the wrapped key"
    description: "Input for the Wrap operation"
